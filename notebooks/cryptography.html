
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Cryptography &#8212; An Introduction to Information Theory for Social Neuroscientists</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/soc_net.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Networks in Social Media" href="networks-in-social-media.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/soc_net.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">An Introduction to Information Theory for Social Neuroscientists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markov-properties.html">
   Markov Chains &amp; Markov Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="network-theory.html">
   Network/Graph Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex-systems.html">
   Complex Systems Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="networks-in-social-media.html">
   Networks in Social Media
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Cryptography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/cosanlab/info-theory-book/main?urlpath=tree/notebooks/cryptography.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/cosanlab/info-theory-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/cosanlab/info-theory-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/cryptography.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/cryptography.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-cell-below-to-download-data-and-prepare-our-environment">
   Run the cell below to download data and prepare our environment!
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Cryptography</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-cell-below-to-download-data-and-prepare-our-environment">
   Run the cell below to download data and prepare our environment!
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="cryptography">
<h1>Cryptography<a class="headerlink" href="#cryptography" title="Permalink to this headline">#</a></h1>
<p><strong>Why cryptography?</strong></p>
<ul class="simple">
<li><p>Cryptographic analysis provides distinct advantages over some more en vogue comp neuro methods, like deep learning</p>
<ul>
<li><p>It sits at a crucial point between supervised and unsupervised learning: you don’t need training labels, but you also pull on pre-existing knowledge about the structure of information in the world</p></li>
</ul>
</li>
<li><p>Cryptographic analysis centers on using the underlying non-uniform distribution of data in the world to decode information</p>
<ul>
<li><p>This is something humans naturally do to learn – e.g. children use morpheme co-ocurance-rates to learn language</p></li>
<li><p>On a similar note, human adults are able to remember larger numbers of social relationships when they exhibit properties that make them representable in a lower number of bits</p></li>
</ul>
</li>
</ul>
<p><strong>What will we cover in this notebook?</strong></p>
<ul class="simple">
<li><p>A hands-on example of using cryptographic analysis to break a substitution cipher in English</p></li>
</ul>
<section id="run-the-cell-below-to-download-data-and-prepare-our-environment">
<h2>Run the cell below to download data and prepare our environment!<a class="headerlink" href="#run-the-cell-below-to-download-data-and-prepare-our-environment" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#file imports
import nltk
from nltk.corpus import words as wordlist
import re
import pandas
from collections import Counter
import matplotlib.pyplot as plt
import numpy as np
import random
import os
from IPython.display import HTML, display
import string

#set random seed and download corpora
os.environ[&#39;PYTHONHASHSEED&#39;] = &#39;0&#39;
nltk.download(&#39;words&#39;)
nltk.download(&#39;gutenberg&#39;)

#make sure the display fits the width of the page
def set_css():
  display(HTML(&#39;&#39;&#39;
  &lt;style&gt;
    pre {
        white-space: pre-wrap;
    }
  &lt;/style&gt;
  &#39;&#39;&#39;))
get_ipython().events.register(&#39;pre_run_cell&#39;, set_css)

def get_letter_distribution(text, plot=False, title=&#39;&#39;, zipfian=False):
  text = re.sub(r&#39;[^a-z]&#39;, &#39;&#39;, text.lower())
  letter_counts = Counter(sorted(text))
  if plot:
    if zipfian:
      letters, vals = zip(*letter_counts.most_common())
      letters = np.array(letters)
      vals = np.array(vals).astype(&#39;float64&#39;)
      vals /= sum(vals)
      plt.bar(letters, vals)
    else:
      plt.bar(letter_counts.keys(), np.array(list(letter_counts.values()))/len(text))
    plt.ylim([0,0.2])
    plt.xlabel(&#39;letter&#39;)
    plt.ylabel(&#39;percentage of all letters&#39;)
    plt.title(title)
    plt.show()
  return letter_counts

alphabet = list(string.ascii_lowercase)
random.shuffle(alphabet)
cipher = dict(zip(sorted(alphabet), alphabet))
for letter in alphabet:
  cipher[letter.upper()] = cipher[letter].upper()

original_quote = nltk.corpus.gutenberg.raw(nltk.corpus.gutenberg.fileids()[1])
encrypted_quote = &#39;&#39;
for letter in original_quote:
  if letter in cipher.keys():
    encrypted_quote+=(cipher[letter])
  else:
    encrypted_quote+=(letter)

def decrypt(encrypted_quote, reverse_cipher):
  unencrypted_quote = &#39;&#39;
  for letter in encrypted_quote:
    if letter in reverse_cipher.keys():
      unencrypted_quote+=(reverse_cipher[letter])
    else:
      unencrypted_quote+=(letter)
  return unencrypted_quote

def fix_single_letter_words(encrypted_quote, reverse_cipher):
  single_letter_words = []
  for word in re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, encrypted_quote.lower()).split():
    if len(word) == 1:
      single_letter_words.append(word)
  (first, count1), (second, count2) = Counter(single_letter_words).most_common()[0:2]  
  if reverse_cipher[first] != &#39;a&#39;:
    for letter in reverse_cipher.keys():
      if reverse_cipher[letter] == &#39;a&#39;:
        reverse_cipher[letter] = reverse_cipher[first]
      if reverse_cipher[letter] == &#39;A&#39;:
        reverse_cipher[letter] = reverse_cipher[first].upper()
    reverse_cipher[first] = &#39;a&#39;
    reverse_cipher[first.upper()] = &#39;A&#39;
  if reverse_cipher[second] != &#39;i&#39;:
    for letter in reverse_cipher.keys():
      if reverse_cipher[letter] == &#39;i&#39;:
        reverse_cipher[letter] = reverse_cipher[second]
      if reverse_cipher[letter] == &#39;I&#39;:
        reverse_cipher[letter] = reverse_cipher[second].upper()
    reverse_cipher[second] = &#39;i&#39;
    reverse_cipher[second.upper()] = &#39;I&#39;
  return reverse_cipher

english = set(wordlist.words())
def get_percent_real(recovered):
  english = set(wordlist.words())
  reals = [word in english for word in re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, recovered.lower()).split()]
  percent_real = sum(reals)/len(reals)
  return percent_real

import copy
def swap_keys(reverse_cipher, L1, L2): 
  updated = copy.deepcopy(reverse_cipher)
  L1V, L2V = reverse_cipher[L1], reverse_cipher[L2]
  updated[L1], updated[L2] = L2V, L1V
  updated[L1.upper()], updated[L2.upper()] = L2V.upper(), L1V.upper()
  return updated

def swap_keys_inplace(reverse_cipher, L1, L2): 
  L1V, L2V = reverse_cipher[L1], reverse_cipher[L2]
  reverse_cipher[L1], reverse_cipher[L2] = L2V, L1V
  reverse_cipher[L1.upper()], reverse_cipher[L2.upper()] = L2V.upper(), L1V.upper()


def improve_deciphering(second_pass, reverse_cipher, percent_real_before):
  english = set(wordlist.words())
  c = get_letter_distribution(second_pass)
  dists = np.ones((26,26))
  for i in range(26):
    for j in range(i+1,26):
      dists[i,j] = abs(c[alphabet[i]] - c[alphabet[j]])/sum(c.values())
  percent_real = percent_real_before
  indeces = np.argsort(dists.flatten())
  while percent_real &lt; 0.81:
    for idx in indeces:
      i,j=np.unravel_index(idx, (26,26))
      L1, L2 = alphabet[i], alphabet[j]
      updated = swap_keys(reverse_cipher, L1, L2)
      unencrypted_quote = &#39;&#39;
      for letter in encrypted_quote:
        if letter in updated.keys():
          unencrypted_quote+=(updated[letter])
        else:
          unencrypted_quote+=(letter)
      reals = [word in english for word in re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, unencrypted_quote.lower()).split()]
      percent_real = sum(reals)/len(reals)
      print(percent_real)
      if percent_real &gt; percent_real_before+(0.82-percent_real_before)/4:
        print(percent_real, &#39;\t&#39;, L1, &#39;\t&#39;,L2,&#39;\n\n&#39;)
        print(re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, unencrypted_quote.lower())[35:776])
        swap_keys_inplace(reverse_cipher, L1, L2)
        percent_real_before = percent_real
        break
    return reverse_cipher
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package words to /home/runner/nltk_data...
[nltk_data]   Unzipping corpora/words.zip.
[nltk_data] Downloading package gutenberg to /home/runner/nltk_data...
[nltk_data]   Unzipping corpora/gutenberg.zip.
</pre></div>
</div>
</div>
</div>
<p>Let’s use some cryptanalysis to solve a letter subtitution cipher. The text below is a passage from a classic novel in which each letter has been replaced with another letter from the English alphabet, with unique pairings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(encrypted_quote[35:776])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frabdto 1


Ygo Iasdto Tssgpd, px Ctssmlfr Rass, gl Ypqtoytdyrgot, iay a qal irp,
xpo rgy pil aqkytqtld, ltvto dppc kb alm nppc nkd drt Naopltdajt;
drtot rt xpklz pffkbadgpl xpo al gzst rpko, alz fplypsadgpl gl a
zgydotyytz plt; drtot rgy xafksdgty itot opkytz gldp azqgoadgpl alz
otybtfd, nm fpldtqbsadglj drt sgqgdtz otqlald px drt taosgtyd badtldy;
drtot alm klitsfpqt ytlyadgply, aogyglj xopq zpqtydgf axxagoy
fraljtz ladkoassm gldp bgdm alz fpldtqbd ay rt dkoltz pvto
drt asqpyd tlzstyy fotadgply px drt sayd ftldkom; alz drtot,
gx tvtom pdrto stax itot bpitostyy, rt fpksz otaz rgy pil rgydpom
igdr al gldtotyd irgfr ltvto xagstz.  Drgy iay drt bajt ad irgfr
drt xavpkogdt vpskqt asiamy pbtltz:

           &quot;TSSGPD PX CTSSMLFR RASS.

&quot;
</pre></div>
</div>
</div>
</div>
<p>If we wanted to decrypt this, we could try a few approaches. We could brute force it, trying every single possible combination of unique letter replacement pairs. This comes out to <span class="math notranslate nohighlight">\(26! = 4.03e^{26}\)</span> potential combinations, which would take a prohibitively long time to run.
<br><br>
A more fruitful aproach might be to use the underlying statistics of the English language to help us seed this process with educated guesses. Let’s take a look at how often particular letters show up in English text (as approximated by a collection of classic novels from Project Gutenberg).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for fileid in nltk.corpus.gutenberg.fileids()[-3:]:
  words = re.sub(r&#39;[^a-z]&#39;, &#39;&#39;, nltk.corpus.gutenberg.raw(fileid).lower())
  get_letter_distribution(words, plot=True, title=fileid)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><img alt="../_images/cryptography_7_1.png" src="../_images/cryptography_7_1.png" />
<img alt="../_images/cryptography_7_2.png" src="../_images/cryptography_7_2.png" />
<img alt="../_images/cryptography_7_3.png" src="../_images/cryptography_7_3.png" />
</div>
</div>
<p>From the above distributions, you can see that some letters are used consistently more frequently than others across these texts. Let’s take a look at the distribution defined be the average of all of these texts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>words = &#39;&#39;
for fileid in nltk.corpus.gutenberg.fileids():
  words += re.sub(r&#39;[^a-z]&#39;, &#39;&#39;, nltk.corpus.gutenberg.raw(fileid).lower())
get_letter_distribution(words, plot=True, title=&#39;Averaged Distribution&#39;);
get_letter_distribution(words, plot=True, title=&#39;Averaged Distribution; Re-Ordered&#39;, zipfian=True);
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><img alt="../_images/cryptography_9_1.png" src="../_images/cryptography_9_1.png" />
<img alt="../_images/cryptography_9_2.png" src="../_images/cryptography_9_2.png" />
</div>
</div>
<p>With this knowledge about expected patterns of letter occurances, let’s see how they compare to the statistics of our encrypted text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>get_letter_distribution(encrypted_quote, plot=True, title=&#39;Encrypted Distribution&#39;);
get_letter_distribution(encrypted_quote, plot=True, title=&#39;Encrypted Distribution; Re-Ordered&#39;, zipfian=True);
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><img alt="../_images/cryptography_11_1.png" src="../_images/cryptography_11_1.png" />
<img alt="../_images/cryptography_11_2.png" src="../_images/cryptography_11_2.png" />
</div>
</div>
<p>As the above distribution shows us, even though each individual letter in the encrypted text no longer has the same occurance probability as it does in typical English text, the general shape of the re-ordered distribution is still the same. We can use this to build a first-pass remapping to attempt deciphering the encrypted text, substituting each encrypted letter with the English letter closest in usage frequency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>quote_dist = list(map(lambda x: x[0], Counter(re.sub(r&#39;[^a-z]&#39;, &#39;&#39;, encrypted_quote.lower())).most_common()))
english_dist = list(map(lambda x: x[0], Counter(re.sub(r&#39;[^a-z]&#39;, &#39;&#39;, words.lower())).most_common()))
reverse_cipher = dict(zip(quote_dist, english_dist))
for letter in alphabet:
  reverse_cipher[letter.upper()] = reverse_cipher[letter].upper()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>first_pass = decrypt(encrypted_quote, reverse_cipher)
print(first_pass[35:776])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fiabter 1


Snr Wadter Eddnot, oc Keddyhfi Iadd, nh Somersetsinre, was a mah wio,
cor ins owh amusemeht, hever took ub ahy pook put tie Parohetage;
tiere ie couhl offubatnoh cor ah nlde iour, ahl fohsodatnoh nh a
lnstressel ohe; tiere ins cafudtnes were rousel nhto almnratnoh ahl
resbeft, py fohtembdatnhg tie dnmntel remhaht oc tie eardnest batehts;
tiere ahy uhwedfome sehsatnohs, arnsnhg crom lomestnf accanrs
fiahgel haturaddy nhto bnty ahl fohtembt as ie turhel over
tie admost ehldess freatnohs oc tie dast fehtury; ahl tiere,
nc every otier deac were bowerdess, ie foudl real ins owh instory
wnti ah nhterest winfi hever candel.  Tins was tie bage at winfi
tie cavournte vodume adways obehel:

           &quot;EDDNOT OC KEDDYHFI IADD.

&quot;
</pre></div>
</div>
</div>
</div>
<p>While our first pass definitely gets us closer to the original text, it’s not quite good enough (unless you, like yours truly, happen to be both a Jane Austen fan and one accustomed to reading through heavy mispellings).
<br><br>
At this point, we’ll want to use some basic facts about English to help us out. For example, we want to make sure that any single-letter words are either assigned to A or I.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>reverse_cipher = fix_single_letter_words(encrypted_quote, reverse_cipher)
second_pass = decrypt(encrypted_quote, reverse_cipher)
print(second_pass[35:776])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fnabter 1


Sir Wadter Eddiot, oc Keddyhfn Nadd, ih Somersetsnire, was a mah wno,
cor nis owh amusemeht, hever took ub ahy pook put tne Parohetage;
tnere ne couhl offubatioh cor ah ilde nour, ahl fohsodatioh ih a
listressel ohe; tnere nis cafudties were rousel ihto almiratioh ahl
resbeft, py fohtembdatihg tne dimitel remhaht oc tne eardiest batehts;
tnere ahy uhwedfome sehsatiohs, arisihg crom lomestif accairs
fnahgel haturaddy ihto bity ahl fohtembt as ne turhel over
tne admost ehldess freatiohs oc tne dast fehtury; ahl tnere,
ic every otner deac were bowerdess, ne foudl real nis owh nistory
witn ah ihterest wnifn hever caidel.  Tnis was tne bage at wnifn
tne cavourite vodume adways obehel:

           &quot;EDDIOT OC KEDDYHFN NADD.

&quot;
</pre></div>
</div>
</div>
</div>
<p>Intuitively, this text feels closer to English text than the previous two. But at this point, we might decide that we want a better metric to determine closeness to the original text than our gut feeling of what looks better.
<br><br>
As we go through the decrypted text (which is significantly larger than the single-paragraph sample displayed above), we can use a cannonical list of English words, then check what percentage of the words in our recovered text are true English words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>percent_real_before = get_percent_real(second_pass)
print(percent_real_before,&#39;% of recovered words were valid English&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.29535548269005385 % of recovered words were valid English
</pre></div>
</div>
</div>
</div>
<p>We can definitely do better than 30% – in fact, the original text contains 81.7% accepted English words. In order to improve our decryption, we’ll try swapping out letter mappings for letters that have the most similar probabilities in English (i.e. R and S both constitute approximately 7.2% of letters used in this corpus). If the percentage of accepted English words improves by making a substitution, we keep it. Let’s watch this technique at work. <em>N.B. This make take a few minutes; feel free to make a nice cup of tea while the next cell runs!</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>c = get_letter_distribution(second_pass)
dists = np.ones((26,26))
for i in range(26):
  for j in range(i+1,26):
    dists[i,j] = abs(c[alphabet[i]] - c[alphabet[j]])/sum(c.values())
percent_real = percent_real_before
indeces = np.argsort(dists.flatten())
while percent_real &lt; 0.81:
  for idx in indeces:
    i,j = np.unravel_index(idx, (26,26))
    L1, L2 = alphabet[i], alphabet[j]
    updated = swap_keys(reverse_cipher, L1, L2)
    unencrypted_quote = &#39;&#39;
    for letter in encrypted_quote:
      if letter in updated.keys():
        unencrypted_quote += (updated[letter])
      else:
        unencrypted_quote += (letter)
    reals = [word in english for word in re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, unencrypted_quote.lower()).split()]
    percent_real = sum(reals)/len(reals)
    if percent_real &gt; percent_real_before+(0.82-percent_real_before)/4:
      print(&#39;swap&#39;, L1.upper(), &#39;and&#39;,L2.upper(),&#39;\tpercent valid English words:&#39;, percent_real,&#39;\n\n&#39;)
      # print(re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, unencrypted_quote.lower())[35:776])
      print(unencrypted_quote[35:776])
      swap_keys_inplace(reverse_cipher, L1, L2)
      percent_real_before = percent_real
      break
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap R and L 	percent valid English words: 0.5160721105097512 


Fhabter 1


Sir Wadter Eddiot, oc Keddynfh Hadd, in Somersetshire, was a man who,
cor his own amusement, never took ub any pook put the Paronetage;
there he counl offubation cor an ilde hour, anl fonsodation in a
listressel one; there his cafudties were rousel into almiration anl
resbeft, py fontembdating the dimitel remnant oc the eardiest batents;
there any unwedfome sensations, arising crom lomestif accairs
fhangel naturaddy into bity anl fontembt as he turnel over
the admost enldess freations oc the dast fentury; anl there,
ic every other deac were bowerdess, he foudl real his own history
with an interest whifh never caidel.  This was the bage at whifh
the cavourite vodume adways obenel:

           &quot;EDDIOT OC KEDDYNFH HADD.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap Z and S 	percent valid English words: 0.6301505155453719 


Fhabter 1


Sir Walter Elliot, oc Kellynfh Hall, in Somersetshire, was a man who,
cor his own amusement, never took ub any pook put the Paronetage;
there he cound offubation cor an idle hour, and fonsolation in a
distressed one; there his cafulties were roused into admiration and
resbeft, py fontemblating the limited remnant oc the earliest batents;
there any unwelfome sensations, arising crom domestif accairs
fhanged naturally into bity and fontembt as he turned over
the almost endless freations oc the last fentury; and there,
ic every other leac were bowerless, he fould read his own history
with an interest whifh never cailed.  This was the bage at whifh
the cavourite volume always obened:

           &quot;ELLIOT OC KELLYNFH HALL.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap F and X 	percent valid English words: 0.7351821857016816 


Chabter 1


Sir Walter Elliot, of Kellynch Hall, in Somersetshire, was a man who,
for his own amusement, never took ub any pook put the Paronetage;
there he found occubation for an idle hour, and consolation in a
distressed one; there his faculties were roused into admiration and
resbect, py contemblating the limited remnant of the earliest batents;
there any unwelcome sensations, arising from domestic affairs
changed naturally into bity and contembt as he turned over
the almost endless creations of the last century; and there,
if every other leaf were bowerless, he could read his own history
with an interest which never failed.  This was the bage at which
the favourite volume always obened:

           &quot;ELLIOT OF KELLYNCH HALL.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap N and B 	percent valid English words: 0.8056729743610003 


Chapter 1


Sir Walter Elliot, of Kellynch Hall, in Somersetshire, was a man who,
for his own amusement, never took up any book but the Baronetage;
there he found occupation for an idle hour, and consolation in a
distressed one; there his faculties were roused into admiration and
respect, by contemplating the limited remnant of the earliest patents;
there any unwelcome sensations, arising from domestic affairs
changed naturally into pity and contempt as he turned over
the almost endless creations of the last century; and there,
if every other leaf were powerless, he could read his own history
with an interest which never failed.  This was the page at which
the favourite volume always opened:

           &quot;ELLIOT OF KELLYNCH HALL.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap W and H 	percent valid English words: 0.8100317359986304 


Chapter 1


Sir Walter Elliot, of Kellynch Hall, in Somersetshire, was a man who,
for his own amusement, never took up any book but the Baronetage;
there he found occupation for an idle hour, and consolation in a
distressed one; there his faculties were roused into admiration and
respect, by contemplating the limited remnant of the earliest patents;
there any unwelcome sensations, arising from domestic affairs
changed naturally into pity and contempt as he turned over
the almost endless creations of the last century; and there,
if every other leaf were powerless, he could read his own history
with an interest which never failed.  This was the page at which
the favourite volume always opened:

           &quot;ELLIOT OF KELLYNCH HALL.

&quot;
</pre></div>
</div>
</div>
</div>
<p>And here we find outselves with the fully recovered opening paragraph of Jane Austen’s timeless classic <em>Persuasion</em>, decrypted in a computationally feasible timeframe, based solely on our pre-existing knowledge of how frequently different letters are used in the English language.
<br><br>
Now that you (hopefully!) have a stronger intuition for frequency-based decryption techniques, my recommended reading is <a class="reference external" href="https://www.nature.com/articles/s41551-017-0169-7">A cryptography-based approach for movement decoding</a> from Eva Dyer and her colleagues in Konrad Kording’s lab, who used this frequency-based approach to decode motor activity from macaque neural recordings.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="networks-in-social-media.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Networks in Social Media</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dhaval Bhatt, Wasita Mahaphanit (primary book maintainer), Katie O'Nell, Sushmita Sadhukha (in alphabetical order)<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>