
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cryptography &#8212; An Introduction to Information Theory for Social Neuroscientists</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/soc_net.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Networks in Social Media" href="networks-in-social-media.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/soc_net.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">An Introduction to Information Theory for Social Neuroscientists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markov-properties.html">
   Markov Chains &amp; Markov Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="network-theory.html">
   Network/Graph Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex-systems.html">
   Complex Systems Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="networks-in-social-media.html">
   Networks in Social Media
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Cryptography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/cryptography.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cosanlab/info-theory-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cosanlab/info-theory-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/cryptography.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cosanlab/info-theory-book/main?urlpath=tree/notebooks/cryptography.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-cell-below-to-download-data-and-prepare-our-environment">
   Run the cell below to download data and prepare our environment!
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Cryptography</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-cell-below-to-download-data-and-prepare-our-environment">
   Run the cell below to download data and prepare our environment!
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="cryptography">
<h1>Cryptography<a class="headerlink" href="#cryptography" title="Permalink to this headline">¶</a></h1>
<p><strong>Why cryptography?</strong></p>
<ul class="simple">
<li><p>Cryptographic analysis provides distinct advantages over some more en vogue comp neuro methods, like deep learning</p>
<ul>
<li><p>It sits at a crucial point between supervised and unsupervised learning: you don’t need training labels, but you also pull on pre-existing knowledge about the structure of information in the world</p></li>
</ul>
</li>
<li><p>Cryptographic analysis centers on using the underlying non-uniform distribution of data in the world to decode information</p>
<ul>
<li><p>This is something humans naturally do to learn – e.g. children use morpheme co-ocurance-rates to learn language</p></li>
<li><p>On a similar note, human adults are able to remember larger numbers of social relationships when they exhibit properties that make them representable in a lower number of bits</p></li>
</ul>
</li>
</ul>
<p><strong>What will we cover in this notebook?</strong></p>
<ul class="simple">
<li><p>A hands-on example of using cryptographic analysis to break a substitution cipher in English</p></li>
</ul>
<div class="section" id="run-the-cell-below-to-download-data-and-prepare-our-environment">
<h2>Run the cell below to download data and prepare our environment!<a class="headerlink" href="#run-the-cell-below-to-download-data-and-prepare-our-environment" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#file imports</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">words</span> <span class="k">as</span> <span class="n">wordlist</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="c1">#set random seed and download corpora</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHONHASHSEED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;words&#39;</span><span class="p">)</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;gutenberg&#39;</span><span class="p">)</span>

<span class="c1">#make sure the display fits the width of the page</span>
<span class="k">def</span> <span class="nf">set_css</span><span class="p">():</span>
  <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  &lt;style&gt;</span>
<span class="s1">    pre {</span>
<span class="s1">        white-space: pre-wrap;</span>
<span class="s1">    }</span>
<span class="s1">  &lt;/style&gt;</span>
<span class="s1">  &#39;&#39;&#39;</span><span class="p">))</span>
<span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s1">&#39;pre_run_cell&#39;</span><span class="p">,</span> <span class="n">set_css</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_letter_distribution</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">zipfian</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
  <span class="n">letter_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
  <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">zipfian</span><span class="p">:</span>
      <span class="n">letters</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">letter_counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">())</span>
      <span class="n">letters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>
      <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
      <span class="n">vals</span> <span class="o">/=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">letters</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">letter_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">letter_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;percentage of all letters&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">letter_counts</span>

<span class="n">alphabet</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">alphabet</span><span class="p">),</span> <span class="n">alphabet</span><span class="p">))</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
  <span class="n">cipher</span><span class="p">[</span><span class="n">letter</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="n">original_quote</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">gutenberg</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">gutenberg</span><span class="o">.</span><span class="n">fileids</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">encrypted_quote</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">original_quote</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">cipher</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">encrypted_quote</span><span class="o">+=</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">encrypted_quote</span><span class="o">+=</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">reverse_cipher</span><span class="p">):</span>
  <span class="n">unencrypted_quote</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">encrypted_quote</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">reverse_cipher</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="n">unencrypted_quote</span><span class="o">+=</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">unencrypted_quote</span><span class="o">+=</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">unencrypted_quote</span>

<span class="k">def</span> <span class="nf">fix_single_letter_words</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">reverse_cipher</span><span class="p">):</span>
  <span class="n">single_letter_words</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">encrypted_quote</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">single_letter_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
  <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">count1</span><span class="p">),</span> <span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">count2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">single_letter_words</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  
  <span class="k">if</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">first</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">reverse_cipher</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
        <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">first</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
        <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">first</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">first</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
    <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">first</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
  <span class="k">if</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">second</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">reverse_cipher</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
        <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">second</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span>
        <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">second</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">second</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span>
    <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">second</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>
  <span class="k">return</span> <span class="n">reverse_cipher</span>

<span class="n">english</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">wordlist</span><span class="o">.</span><span class="n">words</span><span class="p">())</span>
<span class="k">def</span> <span class="nf">get_percent_real</span><span class="p">(</span><span class="n">recovered</span><span class="p">):</span>
  <span class="n">english</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">wordlist</span><span class="o">.</span><span class="n">words</span><span class="p">())</span>
  <span class="n">reals</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="ow">in</span> <span class="n">english</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">recovered</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
  <span class="n">percent_real</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reals</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">reals</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">percent_real</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="k">def</span> <span class="nf">swap_keys</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">):</span> 
  <span class="n">updated</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">)</span>
  <span class="n">L1V</span><span class="p">,</span> <span class="n">L2V</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L1</span><span class="p">],</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L2</span><span class="p">]</span>
  <span class="n">updated</span><span class="p">[</span><span class="n">L1</span><span class="p">],</span> <span class="n">updated</span><span class="p">[</span><span class="n">L2</span><span class="p">]</span> <span class="o">=</span> <span class="n">L2V</span><span class="p">,</span> <span class="n">L1V</span>
  <span class="n">updated</span><span class="p">[</span><span class="n">L1</span><span class="o">.</span><span class="n">upper</span><span class="p">()],</span> <span class="n">updated</span><span class="p">[</span><span class="n">L2</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="n">L2V</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">L1V</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">updated</span>

<span class="k">def</span> <span class="nf">swap_keys_inplace</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">):</span> 
  <span class="n">L1V</span><span class="p">,</span> <span class="n">L2V</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L1</span><span class="p">],</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L2</span><span class="p">]</span>
  <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L1</span><span class="p">],</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L2</span><span class="p">]</span> <span class="o">=</span> <span class="n">L2V</span><span class="p">,</span> <span class="n">L1V</span>
  <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L1</span><span class="o">.</span><span class="n">upper</span><span class="p">()],</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">L2</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="n">L2V</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">L1V</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">improve_deciphering</span><span class="p">(</span><span class="n">second_pass</span><span class="p">,</span> <span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">percent_real_before</span><span class="p">):</span>
  <span class="n">english</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">wordlist</span><span class="o">.</span><span class="n">words</span><span class="p">())</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">second_pass</span><span class="p">)</span>
  <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">26</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">26</span><span class="p">):</span>
      <span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="n">alphabet</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
  <span class="n">percent_real</span> <span class="o">=</span> <span class="n">percent_real_before</span>
  <span class="n">indeces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dists</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
  <span class="k">while</span> <span class="n">percent_real</span> <span class="o">&lt;</span> <span class="mf">0.81</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indeces</span><span class="p">:</span>
      <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
      <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span> <span class="o">=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
      <span class="n">updated</span> <span class="o">=</span> <span class="n">swap_keys</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
      <span class="n">unencrypted_quote</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">encrypted_quote</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">updated</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
          <span class="n">unencrypted_quote</span><span class="o">+=</span><span class="p">(</span><span class="n">updated</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">unencrypted_quote</span><span class="o">+=</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
      <span class="n">reals</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="ow">in</span> <span class="n">english</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">unencrypted_quote</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
      <span class="n">percent_real</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reals</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">reals</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">percent_real</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">percent_real</span> <span class="o">&gt;</span> <span class="n">percent_real_before</span><span class="o">+</span><span class="p">(</span><span class="mf">0.82</span><span class="o">-</span><span class="n">percent_real_before</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">percent_real</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">L2</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">unencrypted_quote</span><span class="o">.</span><span class="n">lower</span><span class="p">())[</span><span class="mi">35</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
        <span class="n">swap_keys_inplace</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
        <span class="n">percent_real_before</span> <span class="o">=</span> <span class="n">percent_real</span>
        <span class="k">break</span>
    <span class="k">return</span> <span class="n">reverse_cipher</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package words to /home/runner/nltk_data...
[nltk_data]   Unzipping corpora/words.zip.
[nltk_data] Downloading package gutenberg to /home/runner/nltk_data...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data]   Unzipping corpora/gutenberg.zip.
</pre></div>
</div>
</div>
</div>
<p>Let’s use some cryptanalysis to solve a letter subtitution cipher. The text below is a passage from a classic novel in which each letter has been replaced with another letter from the English alphabet, with unique pairings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">[</span><span class="mi">35</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jawfmgt 1


Xlt Bwimgt Giilqm, qc Pgiiekja Awii, lk Xqngtxgmxaltg, bwx w nwk baq,
cqt alx qbk wnyxgngkm, kgrgt mqqp yf wke hqqp hym mag Hwtqkgmwdg;
magtg ag cqyko qjjyfwmlqk cqt wk loig aqyt, wko jqkxqiwmlqk lk w
olxmtgxxgo qkg; magtg alx cwjyimlgx bgtg tqyxgo lkmq wonltwmlqk wko
tgxfgjm, he jqkmgnfiwmlkd mag ilnlmgo tgnkwkm qc mag gwtilgxm fwmgkmx;
magtg wke ykbgijqng xgkxwmlqkx, wtlxlkd ctqn oqngxmlj wccwltx
jawkdgo kwmytwiie lkmq flme wko jqkmgnfm wx ag mytkgo qrgt
mag winqxm gkoigxx jtgwmlqkx qc mag iwxm jgkmyte; wko magtg,
lc grgte qmagt igwc bgtg fqbgtigxx, ag jqyio tgwo alx qbk alxmqte
blma wk lkmgtgxm balja kgrgt cwligo.  Malx bwx mag fwdg wm balja
mag cwrqytlmg rqiyng wibwex qfgkgo:

           &quot;GIILQM QC PGIIEKJA AWII.

&quot;
</pre></div>
</div>
</div>
</div>
<p>If we wanted to decrypt this, we could try a few approaches. We could brute force it, trying every single possible combination of unique letter replacement pairs. This comes out to <span class="math notranslate nohighlight">\(26! = 4.03e^{26}\)</span> potential combinations, which would take a prohibitively long time to run.
<br><br>
A more fruitful aproach might be to use the underlying statistics of the English language to help us seed this process with educated guesses. Let’s take a look at how often particular letters show up in English text (as approximated by a collection of classic novels from Project Gutenberg).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">gutenberg</span><span class="o">.</span><span class="n">fileids</span><span class="p">()[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]:</span>
  <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">gutenberg</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
  <span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">fileid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><img alt="../_images/cryptography_7_1.png" src="../_images/cryptography_7_1.png" />
<img alt="../_images/cryptography_7_2.png" src="../_images/cryptography_7_2.png" />
<img alt="../_images/cryptography_7_3.png" src="../_images/cryptography_7_3.png" />
</div>
</div>
<p>From the above distributions, you can see that some letters are used consistently more frequently than others across these texts. Let’s take a look at the distribution defined be the average of all of these texts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">gutenberg</span><span class="o">.</span><span class="n">fileids</span><span class="p">():</span>
  <span class="n">words</span> <span class="o">+=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">gutenberg</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Distribution&#39;</span><span class="p">);</span>
<span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Distribution; Re-Ordered&#39;</span><span class="p">,</span> <span class="n">zipfian</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><img alt="../_images/cryptography_9_1.png" src="../_images/cryptography_9_1.png" />
<img alt="../_images/cryptography_9_2.png" src="../_images/cryptography_9_2.png" />
</div>
</div>
<p>With this knowledge about expected patterns of letter occurances, let’s see how they compare to the statistics of our encrypted text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Encrypted Distribution&#39;</span><span class="p">);</span>
<span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Encrypted Distribution; Re-Ordered&#39;</span><span class="p">,</span> <span class="n">zipfian</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><img alt="../_images/cryptography_11_1.png" src="../_images/cryptography_11_1.png" />
<img alt="../_images/cryptography_11_2.png" src="../_images/cryptography_11_2.png" />
</div>
</div>
<p>As the above distribution shows us, even though each individual letter in the encrypted text no longer has the same occurance probability as it does in typical English text, the general shape of the re-ordered distribution is still the same. We can use this to build a first-pass remapping to attempt deciphering the encrypted text, substituting each encrypted letter with the English letter closest in usage frequency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quote_dist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Counter</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">encrypted_quote</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span><span class="o">.</span><span class="n">most_common</span><span class="p">()))</span>
<span class="n">english_dist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Counter</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">words</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span><span class="o">.</span><span class="n">most_common</span><span class="p">()))</span>
<span class="n">reverse_cipher</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">quote_dist</span><span class="p">,</span> <span class="n">english_dist</span><span class="p">))</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
  <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="n">reverse_cipher</span><span class="p">[</span><span class="n">letter</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_pass</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">reverse_cipher</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_pass</span><span class="p">[</span><span class="mi">35</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fiabter 1


Snr Wadter Eddnot, oc Keddyhfi Iadd, nh Somersetsinre, was a mah wio,
cor ins owh amusemeht, hever took ub ahy pook put tie Parohetage;
tiere ie couhl offubatnoh cor ah nlde iour, ahl fohsodatnoh nh a
lnstressel ohe; tiere ins cafudtnes were rousel nhto almnratnoh ahl
resbeft, py fohtembdatnhg tie dnmntel remhaht oc tie eardnest batehts;
tiere ahy uhwedfome sehsatnohs, arnsnhg crom lomestnf accanrs
fiahgel haturaddy nhto bnty ahl fohtembt as ie turhel over
tie admost ehldess freatnohs oc tie dast fehtury; ahl tiere,
nc every otier deac were bowerdess, ie foudl real ins owh instory
wnti ah nhterest winfi hever candel.  Tins was tie bage at winfi
tie cavournte vodume adways obehel:

           &quot;EDDNOT OC KEDDYHFI IADD.

&quot;
</pre></div>
</div>
</div>
</div>
<p>While our first pass definitely gets us closer to the original text, it’s not quite good enough (unless you, like yours truly, happen to be both a Jane Austen fan and one accustomed to reading through heavy mispellings).
<br><br>
At this point, we’ll want to use some basic facts about English to help us out. For example, we want to make sure that any single-letter words are either assigned to A or I.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reverse_cipher</span> <span class="o">=</span> <span class="n">fix_single_letter_words</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">reverse_cipher</span><span class="p">)</span>
<span class="n">second_pass</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_quote</span><span class="p">,</span> <span class="n">reverse_cipher</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">second_pass</span><span class="p">[</span><span class="mi">35</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fnabter 1


Sir Wadter Eddiot, oc Keddyhfn Nadd, ih Somersetsnire, was a mah wno,
cor nis owh amusemeht, hever took ub ahy pook put tne Parohetage;
tnere ne couhl offubatioh cor ah ilde nour, ahl fohsodatioh ih a
listressel ohe; tnere nis cafudties were rousel ihto almiratioh ahl
resbeft, py fohtembdatihg tne dimitel remhaht oc tne eardiest batehts;
tnere ahy uhwedfome sehsatiohs, arisihg crom lomestif accairs
fnahgel haturaddy ihto bity ahl fohtembt as ne turhel over
tne admost ehldess freatiohs oc tne dast fehtury; ahl tnere,
ic every otner deac were bowerdess, ne foudl real nis owh nistory
witn ah ihterest wnifn hever caidel.  Tnis was tne bage at wnifn
tne cavourite vodume adways obehel:

           &quot;EDDIOT OC KEDDYHFN NADD.

&quot;
</pre></div>
</div>
</div>
</div>
<p>Intuitively, this text feels closer to English text than the previous two. But at this point, we might decide that we want a better metric to determine closeness to the original text than our gut feeling of what looks better.
<br><br>
As we go through the decrypted text (which is significantly larger than the single-paragraph sample displayed above), we can use a cannonical list of English words, then check what percentage of the words in our recovered text are true English words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percent_real_before</span> <span class="o">=</span> <span class="n">get_percent_real</span><span class="p">(</span><span class="n">second_pass</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">percent_real_before</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f recovered words were valid English&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.29535548269005385 % of recovered words were valid English
</pre></div>
</div>
</div>
</div>
<p>We can definitely do better than 30% – in fact, the original text contains 81.7% accepted English words. In order to improve our decryption, we’ll try swapping out letter mappings for letters that have the most similar probabilities in English (i.e. R and S both constitute approximately 7.2% of letters used in this corpus). If the percentage of accepted English words improves by making a substitution, we keep it. Let’s watch this technique at work. <em>N.B. This make take a few minutes; feel free to make a nice cup of tea while the next cell runs!</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">get_letter_distribution</span><span class="p">(</span><span class="n">second_pass</span><span class="p">)</span>
<span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">26</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">26</span><span class="p">):</span>
    <span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="n">alphabet</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">percent_real</span> <span class="o">=</span> <span class="n">percent_real_before</span>
<span class="n">indeces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dists</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="k">while</span> <span class="n">percent_real</span> <span class="o">&lt;</span> <span class="mf">0.81</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indeces</span><span class="p">:</span>
    <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
    <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span> <span class="o">=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="n">updated</span> <span class="o">=</span> <span class="n">swap_keys</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
    <span class="n">unencrypted_quote</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">encrypted_quote</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">updated</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">unencrypted_quote</span> <span class="o">+=</span> <span class="p">(</span><span class="n">updated</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">unencrypted_quote</span> <span class="o">+=</span> <span class="p">(</span><span class="n">letter</span><span class="p">)</span>
    <span class="n">reals</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="ow">in</span> <span class="n">english</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">unencrypted_quote</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
    <span class="n">percent_real</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reals</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">reals</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">percent_real</span> <span class="o">&gt;</span> <span class="n">percent_real_before</span><span class="o">+</span><span class="p">(</span><span class="mf">0.82</span><span class="o">-</span><span class="n">percent_real_before</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;swap&#39;</span><span class="p">,</span> <span class="n">L1</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span><span class="n">L2</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">percent valid English words:&#39;</span><span class="p">,</span> <span class="n">percent_real</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="c1"># print(re.sub(r&#39;[^a-zA-Z ]&#39;, &#39;&#39;, unencrypted_quote.lower())[35:776])</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">unencrypted_quote</span><span class="p">[</span><span class="mi">35</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
      <span class="n">swap_keys_inplace</span><span class="p">(</span><span class="n">reverse_cipher</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
      <span class="n">percent_real_before</span> <span class="o">=</span> <span class="n">percent_real</span>
      <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  pre {
      white-space: pre-wrap;
  }
</style>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap A and K 	percent valid English words: 0.5160721105097512 


Fhabter 1


Sir Wadter Eddiot, oc Keddynfh Hadd, in Somersetshire, was a man who,
cor his own amusement, never took ub any pook put the Paronetage;
there he counl offubation cor an ilde hour, anl fonsodation in a
listressel one; there his cafudties were rousel into almiration anl
resbeft, py fontembdating the dimitel remnant oc the eardiest batents;
there any unwedfome sensations, arising crom lomestif accairs
fhangel naturaddy into bity anl fontembt as he turnel over
the admost enldess freations oc the dast fentury; anl there,
ic every other deac were bowerdess, he foudl real his own history
with an interest whifh never caidel.  This was the bage at whifh
the cavourite vodume adways obenel:

           &quot;EDDIOT OC KEDDYNFH HADD.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap O and I 	percent valid English words: 0.6301505155453719 


Fhabter 1


Sir Walter Elliot, oc Kellynfh Hall, in Somersetshire, was a man who,
cor his own amusement, never took ub any pook put the Paronetage;
there he cound offubation cor an idle hour, and fonsolation in a
distressed one; there his cafulties were roused into admiration and
resbeft, py fontemblating the limited remnant oc the earliest batents;
there any unwelfome sensations, arising crom domestif accairs
fhanged naturally into bity and fontembt as he turned over
the almost endless freations oc the last fentury; and there,
ic every other leac were bowerless, he fould read his own history
with an interest whifh never cailed.  This was the bage at whifh
the cavourite volume always obened:

           &quot;ELLIOT OC KELLYNFH HALL.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap J and C 	percent valid English words: 0.7351821857016816 


Chabter 1


Sir Walter Elliot, of Kellynch Hall, in Somersetshire, was a man who,
for his own amusement, never took ub any pook put the Paronetage;
there he found occubation for an idle hour, and consolation in a
distressed one; there his faculties were roused into admiration and
resbect, py contemblating the limited remnant of the earliest batents;
there any unwelcome sensations, arising from domestic affairs
changed naturally into bity and contembt as he turned over
the almost endless creations of the last century; and there,
if every other leaf were bowerless, he could read his own history
with an interest which never failed.  This was the bage at which
the favourite volume always obened:

           &quot;ELLIOT OF KELLYNCH HALL.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap H and F 	percent valid English words: 0.8056729743610003 


Chapter 1


Sir Walter Elliot, of Kellynch Hall, in Somersetshire, was a man who,
for his own amusement, never took up any book but the Baronetage;
there he found occupation for an idle hour, and consolation in a
distressed one; there his faculties were roused into admiration and
respect, by contemplating the limited remnant of the earliest patents;
there any unwelcome sensations, arising from domestic affairs
changed naturally into pity and contempt as he turned over
the almost endless creations of the last century; and there,
if every other leaf were powerless, he could read his own history
with an interest which never failed.  This was the page at which
the favourite volume always opened:

           &quot;ELLIOT OF KELLYNCH HALL.

&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>swap U and V 	percent valid English words: 0.8100317359986304 


Chapter 1


Sir Walter Elliot, of Kellynch Hall, in Somersetshire, was a man who,
for his own amusement, never took up any book but the Baronetage;
there he found occupation for an idle hour, and consolation in a
distressed one; there his faculties were roused into admiration and
respect, by contemplating the limited remnant of the earliest patents;
there any unwelcome sensations, arising from domestic affairs
changed naturally into pity and contempt as he turned over
the almost endless creations of the last century; and there,
if every other leaf were powerless, he could read his own history
with an interest which never failed.  This was the page at which
the favourite volume always opened:

           &quot;ELLIOT OF KELLYNCH HALL.

&quot;
</pre></div>
</div>
</div>
</div>
<p>And here we find outselves with the fully recovered opening paragraph of Jane Austen’s timeless classic <em>Persuasion</em>, decrypted in a computationally feasible timeframe, based solely on our pre-existing knowledge of how frequently different letters are used in the English language.
<br><br>
Now that you (hopefully!) have a stronger intuition for frequency-based decryption techniques, my recommended reading is <a class="reference external" href="https://www.nature.com/articles/s41551-017-0169-7">A cryptography-based approach for movement decoding</a> from Eva Dyer and her colleagues in Konrad Kording’s lab, who used this frequency-based approach to decode motor activity from macaque neural recordings.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="networks-in-social-media.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Networks in Social Media</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dhaval Bhatt, Katie O'Nell, Sushmita Sadhukha, Wasita Mahaphanit<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>